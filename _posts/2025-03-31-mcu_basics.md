---
title: 单片机基础
author: YooyoJin
date: 2025-04-01
category: Jekyll
layout: post
mermaid: true
---

MCU（Microcontroller Unit，微控制器），将CPU、内存（RAM/ROM）、外设（GPIO、UART、ADC等）集成在单一芯片上的微型计算机系统，专为嵌入式控制设计。例如：STM32（ARM Cortex-M）、ESP32（Wi-Fi/BLE）

SoC（System on Chip，片上系统），在单芯片上集成完整的系统功能，包括CPU、GPU、内存控制器、高速接口（USB/PCIe）、甚至AI加速器等，类似一台微型电脑。例如：高通骁龙、苹果A系列、华为麒麟

## 1. I/O口

I/O口既可用作输入，也可用作输出。

本质上单片机就是对I/O口的控制，无论单片机对外界进行何种控制，都是通过I/O口进行的。接受外部的控制，通过I/O来感受外部的电压。

### 1.1. I/O口结构

推完输出：可以直接输出高电平或低电平，无需外部上拉电阻。本质上由两个MOS管（PMOS和NMOS）组成，一个负责拉高，一个负责拉低。

开漏输出：依赖上拉电阻输出高电平，如果不接上拉电阻，就是高阻态。只有下拉NMOS管，无上拉PMOS管。高电平需依赖外部上拉电阻。

浮空输出：电平状态不确定，易受噪声干扰。输入引脚既不接上拉也不接下拉，处于高阻态（无驱动能力）。

PS:上拉电阻就是将不确定的信号通过一个电阻拉到高电平，同时此电阻起到一个限流的作用，下拉就是下拉到低电平。


## 常见问题&解决办法

### 单片机程序烧录过程中“串电压”问题

像JLink、STLink这类仿真器一般有提供供电引脚给单片机供电。但是仿真器和目标设备（如MCU开发板）分别独立供电时，两者之间的电源系统因电势差或共地问题导致的电压异常，轻则通信失败、重则器件烧毁。

解决办法：所以在程序烧录过程中需要注意电源供电问题，确保统一供电（优先使用目标板为仿真器供电，或关闭目标板电源，仅通过仿真器供电。
）、或共地。

### “ARM仿真器”问题

公司用的ARM仿真器，本来正常使用结果今天这个烧录器一直闪绿灯，我也识别不到JLink，看了下网上的说法，以为是驱动出问题了？尝试重新装了驱动，没有效果。最后换了一个仿真器，能够正常识别。

但是问题来了，重装驱动后，发现程序Keil烧录按钮灰掉了，并且设置JLink会弹出，不能加载JL2CM3.dll驱动！

尝试改了环境变量，无果。

参考 https://zhuanlan.zhihu.com/p/656208641 这篇文章解决。

解决方法：是由于装Jlink驱动的时候，勾选了JLinkARM.dll装进Keil MDK里面去了导致。可以下载老版的Keil，把“Keil安装目录\ARM\Segger”里的库都替换。但是我发现网上下载下来的JLink库太老了，找不到我现在用的芯片，于是直接从新版JLink，找到对应的库替换进去，解决。

不过JLink提示更新的弹窗，更新了就不弹了。

